<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">The Monitor - Bootstrapping a PC from BIOS | Kiril P. Blagoev</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kblagoev.com/blog/bootstrapping-a-pc-from-bios-the-monitor"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="The Monitor - Bootstrapping a PC from BIOS | Kiril P. Blagoev"><meta data-rh="true" name="description" content="You&#x27;re trapped in a basement. You have a computer, but it doesn&#x27;t have an operating system. You have a floppy disk with a boot sector. What&#x27;s on that floppy disk, so it can help you get out of this predicament? Let&#x27;s McGyver ourselves out of this situation!"><meta data-rh="true" property="og:description" content="You&#x27;re trapped in a basement. You have a computer, but it doesn&#x27;t have an operating system. You have a floppy disk with a boot sector. What&#x27;s on that floppy disk, so it can help you get out of this predicament? Let&#x27;s McGyver ourselves out of this situation!"><meta data-rh="true" property="og:image" content="https://kblagoev.com/content/images/2025/02/hi-wilson.jpg"><meta data-rh="true" name="twitter:image" content="https://kblagoev.com/content/images/2025/02/hi-wilson.jpg"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-02-21T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/tihawk"><meta data-rh="true" property="article:tag" content="OS-Development,BIOS-to-OS,Low-Level"><link data-rh="true" rel="icon" href="/img/logo.png"><link data-rh="true" rel="canonical" href="https://kblagoev.com/blog/bootstrapping-a-pc-from-bios-the-monitor"><link data-rh="true" rel="alternate" href="https://kblagoev.com/blog/bootstrapping-a-pc-from-bios-the-monitor" hreflang="en"><link data-rh="true" rel="alternate" href="https://kblagoev.com/blog/bootstrapping-a-pc-from-bios-the-monitor" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kiril P. Blagoev RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kiril P. Blagoev Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EZPFGQ1WWX"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-EZPFGQ1WWX",{})</script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.b2c6c4cf.css">
<link rel="preload" href="/assets/js/runtime~main.7182ce8c.js" as="script">
<link rel="preload" href="/assets/js/main.b1c78f3e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/apps">Apps</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/tihawk" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/bootstrapping-a-pc-from-bios-the-monitor">The Monitor - Bootstrapping a PC from BIOS</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/on-shebangs-being-funky">On shebangs, and their funky behaviour</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/winamp-github-repository-problems">The Winamp GitHub repository is seriously mismanaged. And there&#x27;s nothing they can do about it now.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/using-stow-for-managing dotfiles">How I manage configuration files on my Linux machine using dotfiles and stow</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/developing-on-android-emulator-from-virtualbox">How to connect to an Android Emulator from VirtualBox</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/how-to-remember-what-i-was-reading-about">How to remember what I was reading about?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/key-mission-cyberapocalypse-2021-ctf">Key Mission - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/input-as-a-service-cyberapocalypse-2021-ctf">Input as a Service - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/blitzprop-cyberapocalypse-2021-ctf">BlitzProp - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/caas-cyberapocalypse-2021-ctf">CaaS - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/cyber-apocalypse-2021-capture-the-flag-write-ups">Cyber Apocalypse 2021 Capture the Flag Write-ups</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/alien-camp-cyberapocalypse-2021-ctf">Alien Camp - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/authenticator-cyberapocalypse-2021-ctf">Authenticator - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/passphrase-cyberapocalypse-2021-ctf">Passphrase - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/inspector-gadget-cyberapocalypse-2021-ctf">Inspector Gadget - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/ministrypalace-cyberapocalypse-2021-ctf">miniSTRypalace - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/e-tree-cyberapocalypse-2021-ctf">E.Tree - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/phasestream-3-cyberapocalypse-2021-ctf">Phasestream 3 - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/phasestream-4-cyberapocalypse-2021-ctf">Phasestream 4 - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/nintendo-base64-cyberapocalypse-2021-ctf">Nintendo Base64 - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/emoji-voting-cyberapocalypse-2021-ctf">Emoji Voting - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/soulcrabber-cyberapocalypse-2021-ctf">Soulcrabber - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/wild-goose-hunt-cyberapocalypse-2021-ctf">Wild goose hunt - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/phasestream-1-cyberapocalypse-2021-ctf">Phasestream 1- Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/phasestream-2-cyberapocalypse-2021-ctf">Phasestream 2 - Cyberapocalypse 2021 CTF</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/quantum-programming-abstraction-level-2-algorithms">Quantum Programming - Abstraction level 2: State Machine and Algorithms</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/quantum-programming-abstraction-level-1-logic-gates">Quantum Programming - Abstraction level 1: Logic Gates</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/quantum-programming-abstraction-level-0">Quantum Programming by abstracting ourselves from Quantum Mechanics: Abstraction level 0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/astronavigation-coordinate-systems">Celestial Navigation - coordinate systems</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/on-approximating-irrational-numbers-as-fractions-algorithms">On approximating irrational numbers as fractions (algorithms)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/simulating-the-vicsek-model-how-do-birds-flock-and-insects-swarm">Simulating the Vicsek Model (with time delay) - How do birds flock and insects swarm</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/further-introduction-to-how-do-birds-flock-and-insects-swarm">How do birds flock and insects swarm: the Problem with current models</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/introduction-to-how-do-birds-flock-and-insects-swarm">How do birds flock and insects swarm: the Introduction</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/v-tyrsene-na-zif-vyv-wikipedia">В търсене на Зиф във Википедия</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="image" content="https://kblagoev.com/content/images/2025/02/hi-wilson.jpg"><header><h1 class="title_f1Hy" itemprop="headline">The Monitor - Bootstrapping a PC from BIOS</h1><div class="container_mt6G margin-vert--md"><time datetime="2025-02-21T00:00:00.000Z" itemprop="datePublished">February 21, 2025</time> · <!-- -->13 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/tihawk" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/tihawk.png" alt="Kiril Panayotov Blagoev"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/tihawk" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Kiril Panayotov Blagoev</span></a></div><small class="avatar__subtitle" itemprop="description">Admin</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-long-preamble">A long preamble<a href="#a-long-preamble" class="hash-link" aria-label="Direct link to A long preamble" title="Direct link to A long preamble">​</a></h2><p>As a programmer, it&#x27;s often shocking to me the rift that exists between writing software, and knowing how a computer works. Web developers probably have it the toughest. You can write your React TODO app, and in no time have it effortlessly do dynamic checkboxing galore at the low low cost of thousands of megabytes of memory. And you never have to think about the stupid amount of abstractions that happen under the hood to make this work. The transpiling of Typescript to JavaScript. The JavaScript interpreter building bytecode on the fly. The network protocols defining forms and shapes of data, so that it can be sent, received and parsed by independent participants. The services that the host operating system runs to facilitate all those middle steps. The weaving and bobbing of data between your user space &quot;server&quot; and the OS kernel. The processor threads spawning in and out of existence at the speed of light. It&#x27;s just insane how much happens under the hood. And all written by humans, by the way.</p><p>I have slowly begun to accept that I will never know all of these inner workings and how they function. But my everlasting internal strive for freedom shouts and begs. It wants me to know more, so I can do more. In my vain attempt at achieving ever broader knowledge, I recognise the opportunity to learn to do better at things I am but adequate at. Or, at least such are the delusions of a man, who just wants, nay - needs to always know more.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-gedankenexperiment">The Gedankenexperiment<a href="#the-gedankenexperiment" class="hash-link" aria-label="Direct link to The Gedankenexperiment" title="Direct link to The Gedankenexperiment">​</a></h3><p>In that vein, I propose a thought experiment. Imagine that, due to circumstances out of the scope of this experiment, you find yourself locked in a basement. You have no wants for food or drink, but you need to communicate with the outside world. You have a PC in the basement. And it has a network cable plugged into it. You try turning the PC on, but all you see is the standard IBM PC BIOS start, and that classic POST check happen, with the ubiquitous high-pitched electronic <em>bing</em> to notify you that all is indeed good. But all is not good. The machine has no operating system, so you can&#x27;t even check your Twitter, to make yourself feel good for being locked in a basement. All of that <em>raw</em> computing power right there in front of you, and you can&#x27;t do <em>anything</em> with it!</p><figure><img loading="lazy" src="/content/images/2025/02/no-bootable-device.jpg" class="img_ev3q"><figcaption>An example image to make your heart drop a beat.</figcaption></figure><p>You look around, and you find also a classic 3.5 inch floppy disk sitting on the desk (no, it&#x27;s not a 3D-printed save icon), waiting patiently to be inserted into the floppy drive of the (apparently ancient) PC. You recognise the disk. You know it&#x27;s just short of being empty, apart from something small on the boot sector of it.</p><p>A plan is now condensing onto the dimpled glossy surface of your brain like morning dew on motherboards laying in an electronics garbage dump. You need to write an operating system, some network drivers, a client for one of the hundreds of network protocols, and send a message out!</p><p>The question posed for the thought experiment is: what is on the floppy disk&#x27;s boot sector, such that it would allow you to bootstrap the process?</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>At the end of this preamble, I want to point out that I&#x27;m no OS developer, and this is not a series of articles to teach you how to structure and create the next Linux kernel. This is just me playing around, breaking a lot of things, and learning along the way. Take the information here with a grain of salt, and mainly for entertainment purposes. What I&#x27;m doing here may seem obvious to you, or just plain boring - or it may be as weirdly magical and thought-provoking as it is for me. In either case, you might find something you enjoy. But you&#x27;ve been forewarned - an OS development course this ain&#x27;t.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-bootloader">The bootloader<a href="#the-bootloader" class="hash-link" aria-label="Direct link to The bootloader" title="Direct link to The bootloader">​</a></h2><p>Modern IBM compatible PCs differ from hunks of expensively produced rocks of precious materials in one big way - they tend to have a Basic Input Output System (BIOS) installed on a ROM somewhere on their motherboards. This little program has two main jobs - running a diagnostic Power-On Self-Test (POST), and then giving the control to a user-provided program, which can further utilise the BIOS interrupts if it so desires.</p><p>As it can be seen on the screenshot above, the BIOS will look for bootable devices amongst different media such as CD-Roms, hard-drives and floppy drives. What it&#x27;s looking for in particular is a so-called bootloader program, located on the medium&#x27;s boot sector. What&#x27;s a boot sector? Just a piece of memory, which is exactly 512 bytes long, and ends on the magic number <code>0xAA55</code>. The BIOS will just take these 512 bytes of memory, plop them on memory address <code>0x7C00</code>, and execute them. From there on, it takes no responsibility for what happens, apart from providing some basic input/output capabilities in the form of so-called <em>BIOS interrupts</em>.</p><p>So, our first goal is now becoming clearer. We need to write a program which is up to 512 bytes large, pad the remaining memory with zeroes, and end it with the magic number. Inside of this program, we can make use of BIOS interrupts.</p><p>The last thing we need to take into account is how we address memory. This is a huge topic with regards to how it&#x27;s done in any operating system/hardware combo. For the purposes of this initial step, we can skip the explanations, and just state as a fact, that we will address memory using the so-called &quot;16-bit real mode&quot;. So, we can just address <em>anything</em> we want from address <code>0x0000</code> to <code>0xFFFF</code>. And I mean it when I say anything. We can just read and overwrite anything in that range, potentially just breaking stuff along the way.</p><p>Well, we&#x27;ve pretty much established the first set of constraints of what needs to happen for our thought experiment. On the floppy disk our past selves have thoughtfully provided for us to use, we need to have a program, which:</p><ul><li>Is no larger than 512 bytes.</li><li>Needs to know it will be put on memory address <code>0x7C00</code>.</li><li>Has to end on the magic number <code>0xAA55</code>.</li><li>Can address memory using 16-bit numbers.</li><li>Can use <a href="https://grandidierite.github.io/bios-interrupts/" target="_blank" rel="noopener noreferrer">BIOS interrupts</a> to communicate with hardware.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="wilson">Wilson<a href="#wilson" class="hash-link" aria-label="Direct link to Wilson" title="Direct link to Wilson">​</a></h3><p>So, let&#x27;s turn our silicon-rock-of-a-computer into a virtual Wilson. I&#x27;m providing the assembly snippet that can make that happen, with comments. I hope those comments make sense, since I will attempt to not explain the code in text too much.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[BITS 16]        ; Use 16-bit mode (x86 real mode)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ORG 0x7C00]     ; Origin - BIOS loads boot sector at memory address 0x7C00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; Print &#x27;H&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov ah, 0x0E   ; BIOS teletype output function (INT 10h, AH=0Eh)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov al, &#x27;H&#x27;    ; Character to print</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int 0x10       ; Call BIOS interrupt to display the character</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; Print &#x27;i&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov ah, 0x0E   ; BIOS teletype output function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov al, &#x27;i&#x27;    ; Character to print</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int 0x10       ; Call BIOS interrupt to display the character</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; Infinite loop to prevent the bootloader from proceeding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hang:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jmp hang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Boot sector signature (must be 0xAA55 for BIOS to recognize it as bootable)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">times 510-($-$$) db 0   ; Fill the rest of the boot sector with zeroes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dw 0xAA55               ; Boot sector magic number</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I suspect that the only thing which is harder to grasp is the interrupts themselves. They are just another set of magic numbers that point to routines loaded into memory by BIOS itself. There exists a <a href="https://www.ctyme.com/rbrown.htm" target="_blank" rel="noopener noreferrer">comprehensive list</a> of BIOS interrupts out there, for those curious about them.</p><p>As to how I compile this, put it on a floppy and run it in an emulator: you can check my repository on the matter, called <a href="https://github.com/tihawk/zilch" target="_blank" rel="noopener noreferrer">zilch</a>. Now, let&#x27;s see how Wilson is doing.</p><figure><img loading="lazy" src="/content/images/2025/02/hi-wilson.jpg" class="img_ev3q"><figcaption>Hi, Wilson.</figcaption></figure><p>Excellent! The beginnings of a long-lasting friendship, I&#x27;d imagine.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-monitor">The monitor<a href="#the-monitor" class="hash-link" aria-label="Direct link to The monitor" title="Direct link to The monitor">​</a></h2><p>Now, Wilson is cool and all, but we have to push forward in order to achieve the true objective of our thought experiment. We need to have a program, which would bootstrap our OS-development efforts. If our past selves left a floppy disk with a program that just prints <strong>Hi</strong> on the screen, I don&#x27;t think we&#x27;d get too far. Or be pleased with ourselves.</p><p>What we need is a program, which can receive input from the keyboard, and at some point execute whatever we input. This is called a <strong>monitor</strong>. Let&#x27;s start real-simple-like, and define our monitor as such:</p><ol><li>The <strong>monitor</strong> can read keyboard strokes.</li><li>The input will be called the <strong>program</strong>.</li><li>The user can input the program using octal code (numbers in base 8 (digits from 0 to 7)).</li><li>The monitor will translate this input into hex (numbers in base 16), so that it can be understood as memory addresses, opcodes, and BIOS interrupts.</li><li>The user won&#x27;t see what they&#x27;re typing.</li><li>The user won&#x27;t be able to edit what they type. If they make a mistake, they need to restart the computer and start from scratch.</li><li>The program will be stored on the boot sector, in the empty space between the end of the monitor, and the magic number <code>0xAA55</code>.</li><li>If the user types anything different from a digit from 0 to 7, the monitor will execute the program that has been input so far.</li></ol><p>Point 7 limits the size of our program to <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>512</mn><mo>−</mo><mtext>&lt;size of bootloader&gt;</mtext><mo stretchy="false">)</mo><mtext> bytes</mtext></mrow><annotation encoding="application/x-tex">(512 - \text{&lt;size of bootloader&gt;})\text{ bytes}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">512</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">&lt;size of bootloader&gt;</span></span><span class="mclose">)</span><span class="mord text"><span class="mord"> bytes</span></span></span></span></span></span>. It can be very easily avoided, but let&#x27;s just keep it for now, as a minimalism thing.</p><p>Well, in all honesty, I just described exactly the operation of our little monitor, so let&#x27;s just see it written in assembly.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[BITS 16]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ORG 0x7C00] ; BIOS loads the boot sector here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Main loop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov si, program ; Initialize pointer to the program array</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">input_loop:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov cx, 3 ; Read 3 digits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">digit_input:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; Read a character from the keyboard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    call getch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sub al, &#x27;0&#x27; ; Convert ASCII to numerical value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cmp al, 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ja execute_program ; If input is greater than &#x27;7&#x27;, jump to execute the program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; Multiply the current byte by 8 and add the new digit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov bl, byte [si]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shl bl, 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    add bl, al</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov byte [si], bl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loop digit_input</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; Move to the next byte in the program array</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inc si</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jmp input_loop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Execute the program stored in memory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">execute_program:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    call program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; Infinite loop (halt the CPU)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jmp $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Function to read a character from the keyboard using BIOS interrupt 0x16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">getch:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov ah, 0x00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int 0x16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Reserve the remaining space on the boot sector for the program we input</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">program: times 510-($-$$) db 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Boot sector magic number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dw 0xAA55</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Again, the only special thing in the code itself is that we use BIOS interrupt <code>0x16</code> to read keyboard input. The monitor reads the input, waits for three consecutive digits from 0 to 7 to be input, translates them into hex and stores them in memory. If it detects anything different from these 8 digits, it just jumps to the program we&#x27;ve input so far, and executes it.</p><p>Why 3-digit numbers? Well, with 3 digits in octal we can represent 2 digits in hex (<code>0o377 = 0xFF</code>), which are 8 bits in binary (<code>0xFF = 0b11111111</code>). And so, once we have 3 digits in octal, that means we have a 1 byte number (as long as the octal number is <code>&lt;= 0o377</code>), which we can go ahead and store into memory as the next byte. Let&#x27;s look at an example. If we input the number <code>020</code> into the monitor, this will be translated to the hex byte <code>0x10</code>. Do you know what that byte means? We&#x27;ve seen it before - it&#x27;s the BIOS interrupt for printing onto the screen!</p><p>So, not only can we put random numbers into our monitor, that may or may not mean anything, we can input opcodes, BIOS interrupts and variables into it, constructing machine code that the computer can just run. We&#x27;ve gone to the lowest of low levels! We aren&#x27;t even writing assembly anymore, we are literally speaking CPU-ese now.</p><p>Now, I&#x27;ve gone through the trouble of translating our Wilson program into octal machine code for us to use. It&#x27;s just short enough, so we can test our monitor with it:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">264</span><span class="token plain"> 016 </span><span class="token number" style="color:#36acaa">260</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">110</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">315</span><span class="token plain"> 020 </span><span class="token number" style="color:#36acaa">264</span><span class="token plain"> 016 </span><span class="token number" style="color:#36acaa">260</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">151</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">315</span><span class="token plain"> 020 </span><span class="token number" style="color:#36acaa">364</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>All we have to do now is put our monitor on a floppy, start our PC with it inserted, wait for the BIOS to load the monitor (and display nothing), <em>blindly</em> input the machine code from above (without spaces!), hit a key which is larger than 7, and see if we can revive Wilson!</p><figure><img loading="lazy" src="/content/images/2025/02/hi-wilson-again.png" class="img_ev3q"><figcaption>Hi, Wilson...again</figcaption></figure><p>I mean, at this point you really have to trust me that I did this...or go and do it yourself, using the code in <a href="https://github.com/tihawk/zilch" target="_blank" rel="noopener noreferrer">the repo</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="so-far---so-good">So far - so good<a href="#so-far---so-good" class="hash-link" aria-label="Direct link to So far - so good" title="Direct link to So far - so good">​</a></h2><p>In an extremely minimalistic way, we&#x27;ve technically achieved the requirements of the thought experiment. We have now a <strong>monitor</strong> program, which boots from the boot sector of a floppy disk, and in which we can input machine code to be executed directly from memory.</p><p>The next step would be to write a better monitor program, which has more text-editing capabilities. Then, maybe write a small assembler, so that we can write assembly instead of machine code, and assemble and run it. At that point, we will probably want to also escape real-mode, and go into 32-bit protected mode. Then we can even start writing and compiling C! And then we&#x27;re really off to the races.</p><p>But let&#x27;s just take a minute to appreciate what we&#x27;ve achieved. We do technically have the first step towards bootstrapping an entire computer from BIOS! If we are patient and damn-stubborn enough, we can build an OS from this by never leaving Wilson&#x27;s keyboard again!</p><p>I will do all of these steps, and more, but for the time being I will leave this as is, so it doesn&#x27;t become too cumbersome to read. I&#x27;m going to continue posting on the subject, so keep an eye out! Meanwhile, I hope you&#x27;ve enjoyed the ride so far, and are looking forward to more Bootstrapping from BIOS shenanigans! Have fun!</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/os-development">OS-Development</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/bios-to-os">BIOS-to-OS</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/low-level">Low-Level</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/on-shebangs-being-funky"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">On shebangs, and their funky behaviour</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#a-long-preamble" class="table-of-contents__link toc-highlight">A long preamble</a><ul><li><a href="#the-gedankenexperiment" class="table-of-contents__link toc-highlight">The Gedankenexperiment</a></li></ul></li><li><a href="#the-bootloader" class="table-of-contents__link toc-highlight">The bootloader</a><ul><li><a href="#wilson" class="table-of-contents__link toc-highlight">Wilson</a></li></ul></li><li><a href="#the-monitor" class="table-of-contents__link toc-highlight">The monitor</a></li><li><a href="#so-far---so-good" class="table-of-contents__link toc-highlight">So far - so good</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Random</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/flowfield">Flowfield</a></li><li class="footer__item"><a class="footer__link-item" href="/vicsek">Vicsek model</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/kiro_blagoev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/kblagoev/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/tihawk" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Feed</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://kblagoev.com/blog/rss.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item">RSS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kblagoev.com/blog/atom.xml" target="_blank" rel="noopener noreferrer" class="footer__link-item">Atom<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Kiril Panayotov Blagoev</div></div></div></footer></div>
<script src="/assets/js/runtime~main.7182ce8c.js"></script>
<script src="/assets/js/main.b1c78f3e.js"></script>
</body>
</html>