"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8411],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),d=a,h=u["".concat(l,".").concat(d)]||u[d]||m[d]||o;return n?r.createElement(h,i(i({ref:t},p),{},{components:n})):r.createElement(h,i({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6307:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var r=n(7462),a=(n(7294),n(3905));const o={slug:"alien-camp-cyberapocalypse-2021-ctf",title:"Alien Camp - Cyberapocalypse 2021 CTF",description:"This is a writeup for the Alien Camp challenge, part of the Hack the box's Cyberapocalypse CTF 2021, category Misc.",authors:"kiroki",tags:["Cyber Security","CTF"]},i=void 0,s={permalink:"/blog/alien-camp-cyberapocalypse-2021-ctf",source:"@site/blog/2021-04-29-14:00:49alien-camp-cyberapocalypse-2021-ctf.md",title:"Alien Camp - Cyberapocalypse 2021 CTF",description:"This is a writeup for the Alien Camp challenge, part of the Hack the box's Cyberapocalypse CTF 2021, category Misc.",date:"2021-04-29T00:00:00.000Z",formattedDate:"April 29, 2021",tags:[{label:"Cyber Security",permalink:"/blog/tags/cyber-security"},{label:"CTF",permalink:"/blog/tags/ctf"}],readingTime:2.55,hasTruncateMarker:!0,authors:[{name:"Kiril Panayotov Blagoev",title:"Admin",url:"https://github.com/tihawk",imageURL:"https://github.com/tihawk.png",key:"kiroki"}],frontMatter:{slug:"alien-camp-cyberapocalypse-2021-ctf",title:"Alien Camp - Cyberapocalypse 2021 CTF",description:"This is a writeup for the Alien Camp challenge, part of the Hack the box's Cyberapocalypse CTF 2021, category Misc.",authors:"kiroki",tags:["Cyber Security","CTF"]},prevItem:{title:"Cyber Apocalypse 2021 Capture the Flag Write-ups",permalink:"/blog/cyber-apocalypse-2021-capture-the-flag-write-ups"},nextItem:{title:"Authenticator - Cyberapocalypse 2021 CTF",permalink:"/blog/authenticator-cyberapocalypse-2021-ctf"}},l={authorsImageUrls:[void 0]},c=[{value:"Prompt",id:"prompt",level:3},{value:"Recon",id:"recon",level:3},{value:"Solution",id:"solution",level:3}],p={toc:c},u="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"This is a writeup for the Alien Camp challenge, part of the Hack the box's Cyberapocalypse CTF 2021, category Misc."),(0,a.kt)("h3",{id:"prompt"},"Prompt"),(0,a.kt)("p",null,"The Ministry of Galactic Defense now accepts human applicants for their specialised warrior unit, in exchange for their debt to be erased. We do not want to subject our people to this training and to be used as pawns in their little games. We need you to answer 500 of their questions to pass their test and take them down from the inside."),(0,a.kt)("h3",{id:"recon"},"Recon"),(0,a.kt)("p",null,"We're given a box to which we can connect with ",(0,a.kt)("inlineCode",{parentName:"p"},"netcat"),". On this machine, there's a service which has two options:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Choosing option 1 will give us a list of numbers associated with emojis."),(0,a.kt)("li",{parentName:"ol"},"Choosing option 2 starts an exam, in which we need to supply the answer to 500 arithmetic problems. The only catch is, that the numbers in the equations are represented with the emojis from option 1.")),(0,a.kt)("p",null,"Additionally, every time we connect we will have a different set of emoji -> number dictionary entries."),(0,a.kt)("p",null,"If we try to manually translate the emojis into numbers, and then supply the answer to an equation, we will be (likely) told that we're too slow."),(0,a.kt)("h3",{id:"solution"},"Solution"),(0,a.kt)("p",null,"Therefore, we need to automate the process. The solution will contain the following steps:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Once connected, we will check the emoji -> number relation in option 1, and record it into a dictionary."),(0,a.kt)("li",{parentName:"ol"},"We then start the exam."),(0,a.kt)("li",{parentName:"ol"},"Once supplied with an equation, we do some string manipulation to extract the emojis and arithmetic operations, and translate the emojis into numbers."),(0,a.kt)("li",{parentName:"ol"},"We evaluate the equation, and supply the answer as number."),(0,a.kt)("li",{parentName:"ol"},"We repeat step 3 and 4 500 times to get the flag.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"import socket\nimport time\n\nHOST = '46.101.44.190'\nPORT = 32223\n\n# a generic function to get the response as a string\ndef receive(s):\n  res = ''\n  data = s.recv(1024)\n  res += data.decode()\n  return res\n\n# generate an emoji -> number dictionary\ndef getCode(res):\n  lines = res.split('\\n')\n  arr = lines[2].split(' ')[:-1]\n  emojis = arr[0::3]\n  numbers = arr[2::3]\n  dic = dict(zip(emojis, numbers))\n  return dic\n\n# solve the equation we're provided with\ndef solveEquation(res, dic):\n  lines = res.split('\\n')\n  arr = lines[5].split(' ')[:-1]\n  print(arr)\n  values = arr[0:-1:2]\n  decodedValues = []\n  for value in values:\n    decodedValues.append(dic[value])\n  expressions = arr[1:-2:2]\n  expressions\n  print(decodedValues)\n  print(expressions)\n  index = 0\n  equation = ''\n  for value in decodedValues:\n    equation += value\n    if index < len(expressions):\n      equation += expressions[index]\n    index += 1\n  return str(eval(equation))+'\\n'\n\n# main\nwith socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:\n    s.connect((HOST, PORT))\n    s.settimeout(5)\n    res = ''\n\n    receive(s)\n    time.sleep(0.1)\n\n    # go to option 1, to generate our dictionary\n    buf = '1'\n    buf += '\\n'\n    print(buf)\n    s.send(buf.encode('utf-8'))\n\n    time.sleep(0.5)\n    res = receive(s)\n    dic = getCode(res)\n\n    # start the exam\n    buf = '2'\n    buf += '\\n'\n    print(buf)\n    s.send(buf.encode('utf-8'))\n\n    # keep answering questions until connection is closed\n    while True:\n      time.sleep(0.1)\n      res = receive(s)\n      print(res)\n      answer = solveEquation(res, dic)\n      print(answer)\n      time.sleep(0.1)\n      s.send(answer.encode('utf-8'))\n\n    print (\"Connection closed.\")\n")),(0,a.kt)("p",null,"By the end, we will get the flag in a response"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"CHTB{3v3n_4l13n5_u53_3m0j15_t0_c0mmun1c4t3}\n")))}m.isMDXComponent=!0}}]);