"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2715],{2714:(e,t,n)=>{n.d(t,{A:()=>s});n(6540);const a={"donate-card":"donate-card_mbts",bmac:"bmac_qmhE"};var o=n(4848);function s(){return(0,o.jsx)("div",{className:"alert alert--primary",role:"alert",children:(0,o.jsxs)("div",{className:"card__body",children:[(0,o.jsx)("p",{children:"Thank you for reading!"}),(0,o.jsx)("p",{children:"The information in this blog, as well as all the tools, apps and libraries I develop are currently open source."}),(0,o.jsx)("p",{children:"I would love to keep it this way, and you can help!"}),(0,o.jsx)("p",{children:"You can buy me a coffee from here, which will go towards the next all-nighter I pull off!"}),(0,o.jsx)("a",{href:"https://www.buymeacoffee.com/kblagoev",target:"_blank",children:(0,o.jsx)("img",{src:"https://cdn.buymeacoffee.com/buttons/v2/default-violet.png",className:a.bmac,alt:"Buy Me A Coffee"})}),(0,o.jsxs)("p",{children:["Or you can support me and my code monthly over at ",(0,o.jsx)("a",{href:"https://github.com/sponsors/tihawk",target:"_blank",children:"Github Sponsors!"})]}),(0,o.jsx)("p",{children:"Thanks!"})]})})}},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>l});var a=n(6540);const o={},s=a.createContext(o);function r(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),a.createElement(s.Provider,{value:t},e.children)}},9153:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});var a=n(4848),o=n(8453),s=n(2714);const r={slug:"nintendo-base64-cyberapocalypse-2021-ctf",title:"Nintendo Base64 - Cyberapocalypse 2021 CTF",description:"This is a writeup for the challenge Nintendo Base64, part of the Hack the box's Cyberapocalypse CTF 2021, category Crypto.",authors:"kiroki",tags:["Cyber Security","CTF"]},l=void 0,i={permalink:"/blog/nintendo-base64-cyberapocalypse-2021-ctf",source:"@site/blog/2021-04-28-12:58:58nintendo-base64-cyberapocalypse-2021-ctf.md",title:"Nintendo Base64 - Cyberapocalypse 2021 CTF",description:"This is a writeup for the challenge Nintendo Base64, part of the Hack the box's Cyberapocalypse CTF 2021, category Crypto.",date:"2021-04-28T00:00:00.000Z",formattedDate:"April 28, 2021",tags:[{label:"Cyber Security",permalink:"/blog/tags/cyber-security"},{label:"CTF",permalink:"/blog/tags/ctf"}],readingTime:2.105,hasTruncateMarker:!0,authors:[{name:"Kiril Panayotov Blagoev",title:"Admin",url:"https://github.com/tihawk",imageURL:"https://github.com/tihawk.png",key:"kiroki"}],frontMatter:{slug:"nintendo-base64-cyberapocalypse-2021-ctf",title:"Nintendo Base64 - Cyberapocalypse 2021 CTF",description:"This is a writeup for the challenge Nintendo Base64, part of the Hack the box's Cyberapocalypse CTF 2021, category Crypto.",authors:"kiroki",tags:["Cyber Security","CTF"]},unlisted:!1,prevItem:{title:"Phasestream 4 - Cyberapocalypse 2021 CTF",permalink:"/blog/phasestream-4-cyberapocalypse-2021-ctf"},nextItem:{title:"Emoji Voting - Cyberapocalypse 2021 CTF",permalink:"/blog/emoji-voting-cyberapocalypse-2021-ctf"}},c={authorsImageUrls:[void 0]},d=[{value:"Prompt",id:"prompt",level:3},{value:"Recon",id:"recon",level:3},{value:"Solution",id:"solution",level:3}];function p(e){const t={code:"code",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.p,{children:"This is a writeup for the challenge Nintendo Base64, part of the Hack the box's Cyberapocalypse CTF 2021, category Crypto."}),"\n",(0,a.jsx)(t.h3,{id:"prompt",children:"Prompt"}),"\n",(0,a.jsx)(t.p,{children:"Aliens are trying to cause great misery for the human race by using our own cryptographic technology to encrypt all our games."}),"\n",(0,a.jsx)(t.p,{children:"Fortunately, the aliens haven't played CryptoHack so they're making several noob mistakes. Therefore they've given us a chance to recover our games and find their flags."}),"\n",(0,a.jsx)(t.p,{children:"They've tried to scramble data on an N64 but don't seem to understand that encoding and ASCII art are not valid types of encryption!"}),"\n",(0,a.jsx)(t.h3,{id:"recon",children:"Recon"}),"\n",(0,a.jsxs)(t.p,{children:["Really, the prompt pretty much tells us all we need to know. We look at the ",(0,a.jsx)(t.code,{children:"output.txt"})," file we've received, and see that it's a string of random letters shaped into ASCII art."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-sh",children:"            Vm                                                   0w               eE5GbFdWW         GhT            V0d4VVYwZ\n            G9              XV                                   mx              yWk    ZOV       1JteD           BaV     WRH\n                            YW                                   xa             c1              NsWl dS   M1   JQ WV       d4\nS2RHVkljRm  Rp UjJoMlZrZH plRmRHV m5WaVJtUl hUVEZLZVZk   V1VrZFpWMU  pHVDFaV1Z  tSkdXazlXYW   twdl   Yx    Wm Fj  bHBFVWxWTlZ\nXdz     BWa 2M xVT     FSc  1d   uTl     hi R2h     XWW taS     1dG VXh     XbU ZTT     VdS elYy     cz     FWM    kY2VmtwV2\nJU       RX dZ ak       Zr  U0   ZOc2JGWmlS a3       BY V1       d0 YV       lV MH       hj RVpYYlVaVFRWW  mF lV  mt       3V\nlR       GV 01 ER       kh  Zak  5rVj   JFe VR       Ya Fdha   3BIV mpGU   2NtR kdX     bWx          oT   TB   KW VYxW   lNSM\nWx       XW kV kV       mJ  GWlRZ bXMxY2xWc 1V       sZ  FRiR1J5VjJ  0a1YySkdj   RVpWVmxKV           1V            GRTlQUT09\n"})}),"\n",(0,a.jsx)(t.p,{children:"We can also probably quite safely assume, that this is encoded in base64."}),"\n",(0,a.jsxs)(t.p,{children:["So, as part of our analysis, we strip the string of its spaces and newlines, and feed it to ",(0,a.jsx)(t.code,{children:"base64 -d"})]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-sh",children:"cat output.txt | tr -d ' ' | tr -d \\n | base64 -d\nVm0xNFlWVXhSWGxUV0doWVlrZFNWRmx0ZUdGalZsSlZWR3RPYWxKdGVIcFdiR2h2VkdzeFdGVnViRmRXTTFKeVdWUkdZV1JGT1ZWVmJGWk9WakpvV1ZaclpEUlVNVWw0Vkc1U1RsWnNXbGhWYkZKWFUxWmFSMWRzV2s1V2F6VkpWbTEwYjFkSFNsbFZiRkpXWWtaYU0xcEZXbUZTTVZaeVkwVTFWMDFHYjNkV2EyTXhWakpHVjFScmFGWmlhM0JYV1ZSR1lWZEdVbFZTYms1clVsUldTbGRyV2tkV2JGcEZVVlJWUFE9PQ==\n"})}),"\n",(0,a.jsx)(t.p,{children:"But we notice, that the output of that command is yet another base64 string (given away by the equal signs at the end)."}),"\n",(0,a.jsx)(t.h3,{id:"solution",children:"Solution"}),"\n",(0,a.jsx)(t.p,{children:"So, let's just write a simple script which"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["Opens the ",(0,a.jsx)(t.code,{children:"output.txt"})," file, and strips the content of newlines and spaces"]}),"\n",(0,a.jsxs)(t.li,{children:["Feed it into a loop which applies ",(0,a.jsx)(t.code,{children:"b64decode"})]}),"\n",(0,a.jsxs)(t.li,{children:["And print the output, if it starts with our flag prompt ",(0,a.jsx)(t.code,{children:"CHTB{"})]}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:"#!/usr/bin/env python3\n\nimport base64 as b64\n\nflag = ''\nwith open('output.txt.2', 'r') as f:\n  shouldContinue = True\n  candidate = f.read().replace('\\n', '').replace(' ', '')\n  while shouldContinue:\n    candidate = b64.b64decode(candidate)\n    if b'CHTB{' in candidate:\n      flag = candidate.decode()\n      shouldContinue = False\n\nprint(flag)\n"})}),"\n",(0,a.jsx)(t.p,{children:"So, we get the flag just like that"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-sh",children:"CHTB{3nc0d1ng_n0t_3qu4l_t0_3ncrypt10n}\n"})}),"\n","\n","\n",(0,a.jsx)(s.A,{})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}}}]);