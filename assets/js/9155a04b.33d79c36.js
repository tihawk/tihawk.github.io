"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[542],{2714:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(6540);const a={"donate-card":"donate-card_mbts",bmac:"bmac_qmhE"};function o(){return r.createElement("div",{className:"alert alert--primary",role:"alert"},r.createElement("div",{className:"card__body"},r.createElement("p",null,"Thank you for reading!"),r.createElement("p",null,"The information in this blog, as well as all the tools, apps and libraries I develop are currently open source."),r.createElement("p",null,"I would love to keep it this way, and you can help!"),r.createElement("p",null,"You can buy me a coffee from here, which will go towards the next all-nighter I pull off!"),r.createElement("a",{href:"https://www.buymeacoffee.com/kblagoev",target:"_blank"},r.createElement("img",{src:"https://cdn.buymeacoffee.com/buttons/v2/default-violet.png",className:a.bmac,alt:"Buy Me A Coffee"})),r.createElement("p",null,"Or you can support me and my code monthly over at ",r.createElement("a",{href:"https://github.com/sponsors/tihawk",target:"_blank"},"Github Sponsors!")),r.createElement("p",null,"Thanks!")))}},5004:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>y,frontMatter:()=>l,metadata:()=>c,toc:()=>s});var r=n(8168),a=(n(6540),n(5680)),o=n(2714);const l={slug:"caas-cyberapocalypse-2021-ctf",title:"CaaS - Cyberapocalypse 2021 CTF",description:"This is a writeup for the CaaS challenge, part of the Hack the box's Cyberapocalypse CTF 2021, category Web.",authors:"kiroki",tags:["Cyber Security","CTF"]},i=void 0,c={permalink:"/blog/caas-cyberapocalypse-2021-ctf",source:"@site/blog/2021-04-30-10:57:16caas-cyberapocalypse-2021-ctf.md",title:"CaaS - Cyberapocalypse 2021 CTF",description:"This is a writeup for the CaaS challenge, part of the Hack the box's Cyberapocalypse CTF 2021, category Web.",date:"2021-04-30T00:00:00.000Z",formattedDate:"April 30, 2021",tags:[{label:"Cyber Security",permalink:"/blog/tags/cyber-security"},{label:"CTF",permalink:"/blog/tags/ctf"}],readingTime:1.445,hasTruncateMarker:!0,authors:[{name:"Kiril Panayotov Blagoev",title:"Admin",url:"https://github.com/tihawk",imageURL:"https://github.com/tihawk.png",key:"kiroki"}],frontMatter:{slug:"caas-cyberapocalypse-2021-ctf",title:"CaaS - Cyberapocalypse 2021 CTF",description:"This is a writeup for the CaaS challenge, part of the Hack the box's Cyberapocalypse CTF 2021, category Web.",authors:"kiroki",tags:["Cyber Security","CTF"]},prevItem:{title:"BlitzProp - Cyberapocalypse 2021 CTF",permalink:"/blog/blitzprop-cyberapocalypse-2021-ctf"},nextItem:{title:"Cyber Apocalypse 2021 Capture the Flag Write-ups",permalink:"/blog/cyber-apocalypse-2021-capture-the-flag-write-ups"}},p={authorsImageUrls:[void 0]},s=[{value:"Prompt",id:"prompt",level:3},{value:"Recon",id:"recon",level:3}],u={toc:s},m="wrapper";function y(e){let{components:t,...n}=e;return(0,a.yg)(m,(0,r.A)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("p",null,"This is a writeup for the CaaS challenge, part of the Hack the box's Cyberapocalypse CTF 2021, category Web."),(0,a.yg)("h3",{id:"prompt"},"Prompt"),(0,a.yg)("p",null,"cURL As A Service or CAAS is a brand new Alien application, built so that humans can test the status of their websites. However, it seems that the Aliens have not quite got the hang of Human programming and the application is riddled with issues."),(0,a.yg)("h3",{id:"recon"},"Recon"),(0,a.yg)("p",null,"We are given the source code for a site. The site itself seems to be simply a frontend for executing ",(0,a.yg)("inlineCode",{parentName:"p"},"curl")," on the host machine. If we so desire, we can look into the source code for more details."),(0,a.yg)("p",null,(0,a.yg)("inlineCode",{parentName:"p"},"index.php")," tells us that there exists a POST endpoint ",(0,a.yg)("inlineCode",{parentName:"p"},"/api/curl"),", which takes our host to run curl on as data."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-php"},"[REDACTED]\n\n$router = new Router();\n$router->new('GET', '/', '[email protected]');\n$router->new('POST', '/api/curl', '[email protected]' );\n\n[REDACTED]\n")),(0,a.yg)("p",null,"We also get some information on how that works inside the  ",(0,a.yg)("inlineCode",{parentName:"p"},"controllers/CurlController.php")," file"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-php"},"<?php\nclass CurlController\n{\n    public function index($router)\n    {\n        return $router->view('index');\n    }\n\n    public function execute($router)\n    {\n        $url = $_POST['ip'];\n\n        if (isset($url)) {\n            $command = new CommandModel($url);\n            return json_encode([ 'message' => $command->exec() ]);\n        }\n    }\n}\n")),(0,a.yg)("p",null,"and inside ",(0,a.yg)("inlineCode",{parentName:"p"},"models/CommandModel.php")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-php"},'<?php\nclass CommandModel\n{\n    public function __construct($url)\n    {\n        $this->command = "curl -sL " . escapeshellcmd($url);\n    }\n\n    public function exec()\n    {\n        exec($this->command, $output);\n        return $output;\n    }\n}\n')),(0,a.yg)("p",null,"All of this simply makes us certain that we have to exploit ",(0,a.yg)("inlineCode",{parentName:"p"},"curl"),"."),(0,a.yg)("p",null,"Solution The solution is quite simple, once we realise that we can curl for files inside a file system using ",(0,a.yg)("inlineCode",{parentName:"p"},"file://"),"."),(0,a.yg)("p",null,"With this in mind, we simply send ",(0,a.yg)("inlineCode",{parentName:"p"},"file:///flag")," to our POST endpoint at ",(0,a.yg)("inlineCode",{parentName:"p"},"/api/curl")," , and immediately get the flag"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"CHTB{f1le_r3trieval_4s_a_s3rv1ce}\n")),(0,a.yg)(o.A,{mdxType:"DonateCard"}))}y.isMDXComponent=!0},5680:(e,t,n)=>{n.d(t,{xA:()=>s,yg:()=>h});var r=n(6540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),p=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=p(e.components);return r.createElement(c.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},y=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),u=p(n),y=a,h=u["".concat(c,".").concat(y)]||u[y]||m[y]||o;return n?r.createElement(h,l(l({ref:t},s),{},{components:n})):r.createElement(h,l({ref:t},s))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=y;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i[u]="string"==typeof e?e:a,l[1]=i;for(var p=2;p<o;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}y.displayName="MDXCreateElement"}}]);