"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4466],{2714:(e,t,a)=>{a.d(t,{A:()=>r});a(6540);const s={"donate-card":"donate-card_mbts",bmac:"bmac_qmhE"};var n=a(4848);function r(){return(0,n.jsx)("div",{className:"alert alert--primary",role:"alert",children:(0,n.jsxs)("div",{className:"card__body",children:[(0,n.jsx)("p",{children:"Thank you for reading!"}),(0,n.jsx)("p",{children:"The information in this blog, as well as all the tools, apps and libraries I develop are currently open source."}),(0,n.jsx)("p",{children:"I would love to keep it this way, and you can help!"}),(0,n.jsx)("p",{children:"You can buy me a coffee from here, which will go towards the next all-nighter I pull off!"}),(0,n.jsx)("a",{href:"https://www.buymeacoffee.com/kblagoev",target:"_blank",children:(0,n.jsx)("img",{src:"https://cdn.buymeacoffee.com/buttons/v2/default-violet.png",className:s.bmac,alt:"Buy Me A Coffee"})}),(0,n.jsxs)("p",{children:["Or you can support me and my code monthly over at ",(0,n.jsx)("a",{href:"https://github.com/sponsors/tihawk",target:"_blank",children:"Github Sponsors!"})]}),(0,n.jsx)("p",{children:"Thanks!"})]})})}},8182:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>c,toc:()=>h});var s=a(4848),n=a(8453),r=a(2714);const o={slug:"phasestream-1-cyberapocalypse-2021-ctf",title:"Phasestream 1- Cyberapocalypse 2021 CTF",description:"This is a writeup for the challenge Phasestream 1, part of the Hack the box's Cyberapocalypse CTF 2021, category Crypto.",authors:"kiroki",tags:["Cyber Security","CTF"]},i=void 0,c={permalink:"/blog/phasestream-1-cyberapocalypse-2021-ctf",source:"@site/blog/2021-04-27-18:41:27phasestream-1-cyberapocalypse-2021-ctf.md",title:"Phasestream 1- Cyberapocalypse 2021 CTF",description:"This is a writeup for the challenge Phasestream 1, part of the Hack the box's Cyberapocalypse CTF 2021, category Crypto.",date:"2021-04-27T00:00:00.000Z",formattedDate:"April 27, 2021",tags:[{label:"Cyber Security",permalink:"/blog/tags/cyber-security"},{label:"CTF",permalink:"/blog/tags/ctf"}],readingTime:1.585,hasTruncateMarker:!0,authors:[{name:"Kiril Panayotov Blagoev",title:"Admin",url:"https://github.com/tihawk",imageURL:"https://github.com/tihawk.png",key:"kiroki"}],frontMatter:{slug:"phasestream-1-cyberapocalypse-2021-ctf",title:"Phasestream 1- Cyberapocalypse 2021 CTF",description:"This is a writeup for the challenge Phasestream 1, part of the Hack the box's Cyberapocalypse CTF 2021, category Crypto.",authors:"kiroki",tags:["Cyber Security","CTF"]},unlisted:!1,prevItem:{title:"Wild goose hunt - Cyberapocalypse 2021 CTF",permalink:"/blog/wild-goose-hunt-cyberapocalypse-2021-ctf"},nextItem:{title:"Phasestream 2 - Cyberapocalypse 2021 CTF",permalink:"/blog/phasestream-2-cyberapocalypse-2021-ctf"}},l={authorsImageUrls:[void 0]},h=[{value:"Phasestream 1",id:"phasestream-1",level:3}];function d(e){const t={a:"a",code:"code",em:"em",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"This is a writeup for the challenge Phasestream 1, part of the Hack the box's Cyberapocalypse CTF 2021, category Crypto."}),"\n",(0,s.jsx)(t.h3,{id:"phasestream-1",children:"Phasestream 1"}),"\n",(0,s.jsx)(t.p,{children:"In the first challenge, we're given a hex code, and the knowledge that it's been encoded using XOR with a 5-byte long key."}),"\n",(0,s.jsxs)(t.p,{children:["The top information here, is the length of the key. Since we expect to see a flag pop out of this encoded value, we know that it will start with ",(0,s.jsx)(t.code,{children:"CHTB{"}),", which is exactly 5 bytes long."]}),"\n",(0,s.jsxs)(t.p,{children:["And since the XOR operation is ",(0,s.jsx)(t.em,{children:"its own inverse"}),", we know that if we apply a XOR operation on the encoded value using our known result ",(0,s.jsx)(t.code,{children:"CHTB{"}),' as "key", we will get the original key as output.']}),"\n",(0,s.jsx)(t.p,{children:"We can simply use an online tool for this:"}),"\n",(0,s.jsxs)("figure",{class:"kg-card kg-image-card kg-card-hascaption",children:[(0,s.jsx)("img",{src:"/content/images/2021/04/Screenshot_2021-04-27_21-20-12.png",class:"kg-image",alt:!0,loading:"lazy",width:"429",height:"76"}),(0,s.jsx)("figcaption",{children:"Importing the hex representation of the encoded flag"})]}),"\n",(0,s.jsxs)("figure",{class:"kg-card kg-image-card kg-card-hascaption",children:[(0,s.jsx)("img",{src:"/content/images/2021/04/Screenshot_2021-04-27_21-20-27.png",class:"kg-image",alt:!0,loading:"lazy",width:"260",height:"31"}),(0,s.jsx)("figcaption",{children:'Choosing our "key" as the beginning of the flag'})]}),"\n",(0,s.jsxs)("figure",{class:"kg-card kg-image-card kg-card-hascaption",children:[(0,s.jsx)("img",{src:"/content/images/2021/04/Screenshot_2021-04-27_21-20-39.png",class:"kg-image",alt:!0,loading:"lazy",width:"246",height:"24"}),(0,s.jsx)("figcaption",{children:'Getting the 5-byte key to be "mykey"'})]}),"\n",(0,s.jsxs)(t.p,{children:["We get our key to be ",(0,s.jsx)(t.code,{children:"mykey"}),"!"]}),"\n",(0,s.jsxs)(t.p,{children:["We could also do this using ",(0,s.jsx)(t.a,{href:"https://github.com/AlexFSmirnov/xor-decrypt",children:"this"})," tool to do the same, since we can supply a key to it to decode. But we need to supply it with an ASCII representation of the encoded result."]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Decode the hex of the encrypted flag into ASCII"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"echo 2e313f2702184c5a0b1e321205550e03261b094d5c171f56011904 | xxd -r -ps > encodedascii.txt\n"})}),"\n",(0,s.jsxs)(t.ol,{start:"2",children:["\n",(0,s.jsxs)(t.li,{children:["Find the key by supplying the encrypted flag to ",(0,s.jsx)(t.code,{children:"xor-decrypt"}),", and ",(0,s.jsx)(t.code,{children:"CHTB{"})," as key"]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:'python3 xor-decrypt.py -i "encodedascii.txt" -o key.txt -k CHTB{ -d\n'})}),"\n",(0,s.jsxs)(t.p,{children:["So we get ",(0,s.jsx)(t.code,{children:"mykey[IeqZQu@nOK6_KzZL"}),", and deduce that ",(0,s.jsx)(t.code,{children:"mykey"})," is the 5-byte key"]}),"\n",(0,s.jsxs)(t.ol,{start:"3",children:["\n",(0,s.jsx)(t.li,{children:"Decrypt the encrypted flag using our key"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"python3 xor-decrypt.py -i encodedascii.txt -o flag.txt -k mykey -d\n"})}),"\n",(0,s.jsx)(t.p,{children:"And so, our flag finally is"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"CHTB{u51ng_kn0wn_pl41nt3xt}\n"})}),"\n","\n","\n",(0,s.jsx)(r.A,{})]})}function p(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,a)=>{a.d(t,{R:()=>o,x:()=>i});var s=a(6540);const n={},r=s.createContext(n);function o(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);